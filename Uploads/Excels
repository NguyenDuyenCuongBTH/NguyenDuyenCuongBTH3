public async Task<IActionResult> Upload()
{
    return View():
}
[HttpPost]
[ValidateAntiForgeryToken]
0 references
public async Task<IActionResult> Upload (IFormFile file)
{
    if (file!=null)
    {
    string fileExtension=Path.GetExtension(file.FileName):
    if (fileExtension != ".xls" && fileExtension!=".xlsx")
{
ModelState.AddModelError(", "Please choose excel file to upload!") :
}
else
{
//rename file when upload to server
var fileName = DateTime.Now.ToShortTimeString() + fileExtension;
var filePath = Path. Combine(Directory.GetCurrentDirectory() + "/Uploads/Excels". fileName)
var fileLocation = new FileInfo(filePath).ToString();
using (var stream = new FileStream(filePath, FileMode.Create))
{
//save file to server
await file.CopyToAsync(stream);
}
}
}
return View();
}